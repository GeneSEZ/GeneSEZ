/**
 * 	Validates the model for code generation
 *  
 * @author	Nico Herbig <nico.herbig@fh-zwickau.de>
 * @date	2011-05-07
 */

// based on genesez meta model
import gcore;

// use TYPO3 MVC access helper scripts which overrides
// common access helper scripts if script name is equal
extension org::genesez::platform::typo3cms::mvc::util::AccessElement;
extension org::genesez::metamodel::core::util::AccessElement;


/*
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
*/

// properties in entities und value objects protected

// attributes only single values 

/**
 * Checks if the visibility of attributes and association roles is 'protected' of TYPO3 MVC Extbase entities or value objects.
 * 
 * @return	False, if the visibility is not 'protected', otherwise true.
 */
context MProperty WARNING "GeneSEZ: Visibility of the property for the domain object is not protected!" :
	classifier.metaType == MClass && ( ((MClass)classifier).isEntity() || ((MClass)classifier).isValueObject() )
		? visibility == "protected"
		: true;


/**
 * Checks if the multiplicity of attributes with type is no classifier is '0' or '1' of TYPO3 MVC Extbase entities or value objects.
 * 
 * @return	False, if the multiplicity is not '0' or '1', otherwise true.
 */	
context MAttribute WARNING "GeneSEZ: Could not handle multi valued attributes for types which are no classifier!" :
	classifier.metaType == MClass && ( ((MClass)classifier).isEntity() || ((MClass)classifier).isValueObject() ) && !type.isClassifier()
		? multiplicity.isSingleValued()
		: true;