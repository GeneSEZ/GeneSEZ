/*
 * (c) GeneSEZ Research Group
 * All rights reserved.
 *
 * Licensed according to GeneSEZ License Terms <http://www.genesez.org/en/license>
 */

import gcore;


/**
 * Validation rules for TYPO3 CMS specific Extbase + Fluid.
 *  
 * @author	Nico Herbig <nico.herbig@fh-zwickau.de> (maintainer)
 */

// use GeneSEZ common Persistence profile scripts
extension org::genesez::metamodel::core::util::profile::GenesezPersistenceAccessElement;


// use TYPO3 CMS specific Extbase + Fluid access element scripts
extension org::genesez::platform::typo3::cms::mvc::util::AccessElement;


// use GeneSEZ common access element scripts
extension org::genesez::metamodel::core::util::AccessElement;

// use GeneSEZ common conversion scripts
extension org::genesez::metamodel::core::util::Conversion;


// -- Property Checks ---------------------------------------------------------------------------------------

/**
 * Checks if the visibility of attributes from domain objects is 'protected'.
 * 
 * @return	False, if the visibility is not 'protected', otherwise true.
 */
context MAttribute 
	if ( classifier.isEntity() || classifier.isValueObject() ) && !( derived || ( static && final ) || emHasTransientStereotype() ) 
	WARNING "GeneSEZ: The visibility of the attribute from the domain object is not protected! See model element: " + fqmn() :
	visibility == "protected";

/**
 * Checks if the visibility of association roles from domain objects is 'protected'.
 * 
 * @return	False, if the visibility is not 'protected', otherwise true.
 */
context MAssociationRole 
	if ( classifier.isEntity() || classifier.isValueObject() ) && ! ( derived || emHasTransientStereotype() )
	WARNING "GeneSEZ: The visibility of the association role from the domain object is not protected! See model element: " + fqmn() :
	visibility == "protected";


/**
 * Checks if no default enumeration value is set for an attribute.
 * Hint: PHP does not support an object initialization, see http://php.net/manual/en/language.oop5.properties.php. 
 * 
 * @return	False, if the default enumeration value is set, otherwise true.
 */
context MAttribute 
	if type.isEnumeration()
	WARNING "GeneSEZ: The default enumeration value of the attribute could not be generated, because PHP does not support object initializations. Please set the default value through the constructor of this classifier or otherwise! See model element: " + fqmn() :
	!hasDefaultValue();